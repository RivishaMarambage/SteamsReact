
{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "type": "object",
      "description": "Represents a user's profile, including their role and loyalty information.",
      "properties": {
        "id": { "type": "string", "description": "User's unique ID (matches Auth UID)." },
        "email": { "type": "string", "format": "email", "description": "User's email address." },
        "name": { "type": "string", "description": "User's full name." },
        "mobileNumber": { "type": "string", "description": "User's mobile phone number." },
        "cafeNickname": { "type": "string", "description": "User's preferred nickname for order callouts." },
        "loyaltyPoints": { "type": "number", "description": "Accumulated loyalty points." },
        "lifetimePoints": { "type": "number", "description": "Total points accumulated over the user's lifetime, not reduced by redemptions." },
        "loyaltyLevelId": { "type": "string", "description": "ID of the user's current loyalty level." },
        "role": { "type": "string", "enum": ["customer", "staff", "admin"], "description": "The user's role in the system." },
        "dateOfBirth": { "type": "string", "format": "date", "description": "User's date of birth." },
        "birthdayDiscountValue": { "type": "number", "description": "The value of the birthday discount (fixed amount or percentage)." },
        "birthdayDiscountType": { "type": "string", "enum": ["fixed", "percentage"], "description": "The type of birthday discount." },
        "birthdayFreebieMenuItemIds": { "type": "array", "items": { "type": "string" }, "description": "List of menu item IDs awarded as a birthday freebie." },
        "welcomeOfferRedeemed": { "type": "boolean", "description": "Whether the user has redeemed their one-time welcome offer." },
        "emailVerified": { "type": "boolean", "description": "Mirrors the email verification status from Firebase Auth." }
      },
      "required": ["id", "email", "name", "role"]
    },
    "MenuItem": {
      "title": "Menu Item",
      "type": "object",
      "description": "A single item available on the cafe's menu.",
      "properties": {
        "id": { "type": "string", "description": "Unique ID for the menu item." },
        "name": { "type": "string", "description": "Name of the menu item." },
        "description": { "type": "string", "description": "A brief description of the item." },
        "price": { "type": "number", "description": "Price of the item." },
        "categoryId": { "type": "string", "description": "The ID of the category this item belongs to." },
        "imageUrl": { "type": "string", "description": "URL of an image for the menu item." },
        "isOutOfStock": { "type": "boolean", "description": "Whether the item is currently out of stock." }
      },
      "required": ["id", "name", "price", "categoryId"]
    },
    "Category": {
      "title": "Category",
      "type": "object",
      "description": "A category for organizing menu items.",
      "properties": {
        "id": { "type": "string", "description": "Unique ID for the category." },
        "name": { "type": "string", "description": "Name of the category (e.g., 'Coffee Classics')." },
        "type": { "type": "string", "description": "A broader type for grouping categories (e.g., 'coffee')." }
      },
      "required": ["id", "name", "type"]
    },
    "LoyaltyLevel": {
      "title": "Loyalty Level",
      "type": "object",
      "description": "Defines a tier in the loyalty program.",
      "properties": {
        "id": { "type": "string", "description": "Unique ID for the loyalty level (e.g., 'gold')." },
        "name": { "type": "string", "description": "Display name of the level (e.g., 'Gold')." },
        "minimumPoints": { "type": "number", "description": "Points required to reach this level." }
      },
      "required": ["id", "name", "minimumPoints"]
    },
    "Order": {
      "title": "Order",
      "type": "object",
      "description": "Represents a customer's order for pickup.",
      "properties": {
        "id": { "type": "string", "description": "Unique ID for the order." },
        "customerId": { "type": "string", "description": "The UID of the user who placed the order." },
        "orderDate": { "type": "string", "format": "date-time", "description": "Timestamp of when the order was placed." },
        "totalAmount": { "type": "number", "description": "Total cost of the order." },
        "status": { "type": "string", "enum": ["Placed", "Processing", "Ready for Pickup", "Completed", "Rejected"], "description": "Current status of the order." },
        "menuItemIds": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of IDs of the menu items in the order."
        },
        "orderType": {
            "type": "string",
            "enum": ["Dine-in", "Takeaway"],
            "description": "The type of order."
        },
        "tableNumber": {
            "type": "string",
            "description": "The table number for dine-in orders."
        },
        "pointsRedeemed": {
          "type": "number",
          "description": "The number of loyalty points redeemed for this order."
        },
        "discountApplied": {
          "type": "number",
          "description": "The monetary discount applied to this order from redeemed points."
        },
        "serviceCharge": {
            "type": "number",
            "description": "The service charge applied to the order (e.g., for dine-in)."
        },
        "pointsToEarn": {
          "type": "number",
          "description": "The number of loyalty points to be awarded when the order is completed."
        }
      },
      "required": ["id", "customerId", "orderDate", "totalAmount", "status", "menuItemIds", "orderType"]
    },
    "DailyOffer": {
      "title": "Daily Offer",
      "type": "object",
      "description": "Represents a special daily offer for a menu item.",
      "properties": {
        "id": { "type": "string", "description": "Unique ID for the offer." },
        "title": { "type": "string", "description": "Title of the offer (e.g., 'Muffin Monday')." },
        "menuItemId": { "type": "string", "description": "The ID of the menu item on offer." },
        "tierDiscounts": {
          "type": "object",
          "description": "A map of loyalty tier IDs to their specific discount value.",
          "additionalProperties": {
            "type": "number"
          }
        },
        "discountType": {
            "type": "string",
            "enum": ["fixed", "percentage"],
            "description": "The type of discount (LKR or %)."
        },
        "orderType": {
            "type": "string",
            "enum": ["Dine-in", "Takeaway"],
            "description": "The type of order the offer applies to."
        },
        "offerStartDate": { "type": "string", "description": "The start date of the offer, in YYYY-MM-DD format." },
        "offerEndDate": { "type": "string", "description": "The end date of the offer, in YYYY-MM-DD format." }
      },
      "required": ["id", "title", "menuItemId", "tierDiscounts", "discountType", "offerStartDate", "offerEndDate"]
    }
  },
  "auth": {
    "providers": ["password", "anonymous"]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": { "$ref": "#/entities/UserProfile" },
          "description": "Stores user profile data. Secured by user ID.",
          "params": [{ "name": "userId", "description": "The user's unique auth ID." }]
        }
      },
      {
        "path": "/menu_items/{menuItemId}",
        "definition": {
          "entityName": "MenuItem",
          "schema": { "$ref": "#/entities/MenuItem" },
          "description": "Publicly readable list of all menu items.",
          "params": [{ "name": "menuItemId", "description": "Unique ID for the menu item." }]
        }
      },
      {
        "path": "/categories/{categoryId}",
        "definition": {
          "entityName": "Category",
          "schema": { "$ref": "#/entities/Category" },
          "description": "Publicly readable list of all menu categories.",
          "params": [{ "name": "categoryId", "description": "Unique ID for the category." }]
        }
      },
      {
        "path": "/loyalty_levels/{loyaltyLevelId}",
        "definition": {
          "entityName": "LoyaltyLevel",
          "schema": { "$ref": "#/entities/LoyaltyLevel" },
          "description": "Publicly readable list of all loyalty levels.",
          "params": [{ "name": "loyaltyLevelId", "description": "Unique ID for the loyalty level." }]
        }
      },
      {
        "path": "/orders/{orderId}",
        "definition": {
          "entityName": "Order",
          "schema": { "$ref": "#/entities/Order" },
          "description": "Root collection for all orders. Used by staff and admins for management.",
          "params": [{ "name": "orderId", "description": "Unique ID for the order." }]
        }
      },
      {
        "path": "/users/{userId}/orders/{orderId}",
        "definition": {
          "entityName": "Order",
          "schema": { "$ref": "#/entities/Order" },
          "description": "A customer's private copy of their order history. Path-based ownership.",
          "params": [
            { "name": "userId", "description": "The user's unique auth ID." },
            { "name": "orderId", "description": "Unique ID for the order, matches the ID in the root /orders collection." }
          ]
        }
      },
      {
        "path": "/daily_offers/{offerId}",
        "definition": {
          "entityName": "DailyOffer",
          "schema": { "$ref": "#/entities/DailyOffer" },
          "description": "Publicly readable list of daily offers. Writable only by admins.",
          "params": [{ "name": "offerId", "description": "Unique ID for the daily offer." }]
        }
      }
    ]
  }
}
